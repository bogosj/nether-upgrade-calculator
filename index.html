<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nether Resource Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .custom-checkbox:checked {
            background-color: #4f46e5;
            border-color: #4f46e5;
        }
        .custom-checkbox:checked::after {
            content: '✔';
            color: white;
            display: block;
            text-align: center;
            line-height: 1.25rem;
            font-size: 0.8rem;
        }
        /* Hide number input arrows */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
    </style>
</head>
<body class="bg-gray-900 text-white antialiased">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-5xl">
        
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-indigo-400">Nether Resource Tracker</h1>
            <p class="text-gray-400 mt-2">Check off the upgrades you still need to calculate the total cost.</p>
        </header>

        <!-- Production & Spawning Section -->
        <div class="bg-gray-800 shadow-lg rounded-xl p-6 mb-8 border border-gray-700">
            <h2 class="text-xl font-semibold mb-4 text-white">Production & Spawning</h2>
            <div class="text-center">
                <div class="inline-grid grid-cols-1 sm:grid-cols-3 gap-6 mb-6 text-left">
                    <!-- Netherlings -->
                    <div class="bg-gray-700 p-4 rounded-lg">
                        <label for="flames-per-netherling" class="block text-sm font-medium text-gray-300 mb-2">Flames per Netherling</label>
                        <input type="number" id="flames-per-netherling" class="bg-gray-900 text-white w-full rounded-md p-2 text-center font-bold text-lg border border-gray-600 focus:ring-indigo-500 focus:border-indigo-500" placeholder="0" min="0">
                        <p class="text-xs text-gray-400 mt-2 text-center">Spawn Cost: 1 Orb</p>
                    </div>
                    <!-- Demons -->
                    <div class="bg-gray-700 p-4 rounded-lg">
                        <label for="crystals-per-demon" class="block text-sm font-medium text-gray-300 mb-2">Crystals per Demon</label>
                        <input type="number" id="crystals-per-demon" class="bg-gray-900 text-white w-full rounded-md p-2 text-center font-bold text-lg border border-gray-600 focus:ring-indigo-500 focus:border-indigo-500" placeholder="0" min="0">
                        <p class="text-xs text-gray-400 mt-2 text-center">Spawn Cost: 3 Orbs, 10 Flames</p>
                    </div>
                    <!-- Mountains -->
                    <div class="bg-gray-700 p-4 rounded-lg">
                        <label for="stars-per-mountain" class="block text-sm font-medium text-gray-300 mb-2">Stars per Mountain</label>
                        <input type="number" id="stars-per-mountain" class="bg-gray-900 text-white w-full rounded-md p-2 text-center font-bold text-lg border border-gray-600 focus:ring-indigo-500 focus:border-indigo-500" placeholder="0" min="0">
                        <p class="text-xs text-gray-400 mt-2 text-center">Spawn Cost: 12 Crystals</p>
                    </div>
                </div>
            </div>
            <h3 class="text-lg font-semibold mb-4 text-white">Total Spawn Cost:</h3>
             <div id="spawn-costs" class="grid grid-cols-2 sm:grid-cols-4 gap-4 text-center">
                <div class="bg-gray-700 p-4 rounded-lg">
                    <span class="text-2xl font-bold text-purple-400" id="spawn-cost-orbs">0</span>
                    <span class="block text-sm text-gray-300">Orbs</span>
                </div>
                <div class="bg-gray-700 p-4 rounded-lg">
                    <span class="text-2xl font-bold text-orange-400" id="spawn-cost-flames">0</span>
                    <span class="block text-sm text-gray-300">Flames</span>
                </div>
                <div class="bg-gray-700 p-4 rounded-lg">
                    <span class="text-2xl font-bold text-cyan-400" id="spawn-cost-crystals">0</span>
                    <span class="block text-sm text-gray-300">Crystals</span>
                </div>
                <div class="bg-gray-700 p-4 rounded-lg">
                    <span class="text-2xl font-bold text-yellow-400" id="spawn-cost-stars">0</span>
                    <span class="block text-sm text-gray-300">Stars</span>
                </div>
            </div>
        </div>

        <!-- Current Resources Section -->
        <div class="bg-gray-800 shadow-lg rounded-xl p-6 mb-8 border border-gray-700">
            <h2 class="text-xl font-semibold mb-4 text-white">Current Resources:</h2>
            <div id="current-resources" class="grid grid-cols-2 sm:grid-cols-4 gap-4">
                <div class="bg-gray-700 p-4 rounded-lg flex flex-col items-center">
                    <label for="current-orbs" class="block text-sm text-gray-300 mb-2">Orbs</label>
                    <input type="number" id="current-orbs" class="bg-gray-900 text-white w-full rounded-md p-2 text-center font-bold text-lg border border-gray-600 focus:ring-indigo-500 focus:border-indigo-500" placeholder="0" min="0">
                </div>
                <div class="bg-gray-700 p-4 rounded-lg flex flex-col items-center">
                     <label for="current-flames" class="block text-sm text-gray-300 mb-2">Flames</label>
                     <input type="number" id="current-flames" class="bg-gray-900 text-white w-full rounded-md p-2 text-center font-bold text-lg border border-gray-600 focus:ring-indigo-500 focus:border-indigo-500" placeholder="0" min="0">
                </div>
                <div class="bg-gray-700 p-4 rounded-lg flex flex-col items-center">
                     <label for="current-crystals" class="block text-sm text-gray-300 mb-2">Crystals</label>
                     <input type="number" id="current-crystals" class="bg-gray-900 text-white w-full rounded-md p-2 text-center font-bold text-lg border border-gray-600 focus:ring-indigo-500 focus:border-indigo-500" placeholder="0" min="0">
                </div>
                <div class="bg-gray-700 p-4 rounded-lg flex flex-col items-center">
                     <label for="current-stars" class="block text-sm text-gray-300 mb-2">Stars</label>
                     <input type="number" id="current-stars" class="bg-gray-900 text-white w-full rounded-md p-2 text-center font-bold text-lg border border-gray-600 focus:ring-indigo-500 focus:border-indigo-500" placeholder="0" min="0">
                </div>
            </div>
        </div>

        <!-- Totals Section -->
        <div class="bg-gray-800 shadow-lg rounded-xl p-6 mb-8 sticky top-4 z-10 border border-gray-700">
            <h2 class="text-xl font-semibold mb-4 text-white">Total Resources Needed for Spawns Plus Upgrades</h2>
            <div id="totals" class="grid grid-cols-2 sm:grid-cols-4 gap-4 text-center">
                <div class="bg-gray-700 p-4 rounded-lg">
                    <span class="text-2xl font-bold text-purple-400" id="total-orbs">0</span>
                    <span class="block text-sm text-gray-300">Orbs</span>
                </div>
                <div class="bg-gray-700 p-4 rounded-lg">
                    <span class="text-2xl font-bold text-orange-400" id="total-flames">0</span>
                    <span class="block text-sm text-gray-300">Flames</span>
                </div>
                <div class="bg-gray-700 p-4 rounded-lg">
                    <span class="text-2xl font-bold text-cyan-400" id="total-crystals">0</span>
                    <span class="block text-sm text-gray-300">Crystals</span>
                </div>
                <div class="bg-gray-700 p-4 rounded-lg">
                    <span class="text-2xl font-bold text-yellow-400" id="total-stars">0</span>
                    <span class="block text-sm text-gray-300">Stars</span>
                </div>
            </div>
        </div>

        <!-- Upgrades List -->
        <main id="upgrades-container" class="space-y-6">
            <!-- Upgrade categories will be injected here by JavaScript -->
        </main>

        <!-- Strategy Section -->
        <div class="bg-gray-800 shadow-lg rounded-xl p-6 mt-8 border border-gray-700">
            <h2 class="text-xl font-semibold mb-4 text-white">Plan of Action</h2>
            <div id="strategy-text" class="text-gray-300 space-y-2 prose prose-invert max-w-none">
                <p>Select some upgrades and enter your production rates to see a step-by-step plan.</p>
            </div>
        </div>

    </div>

    <script>
        // Data for upgrades will be built here
        const upgradesData = [
            { id: 1, category: 'Netherling', name: 'Level 1', orbs: 5, needed: true },
            { id: 2, category: 'Netherling', name: 'Level 2', crystals: 10, needed: true },
            { id: 3, category: 'Netherling', name: 'Level 3', flames: 60, stars: 3, needed: true },
            { id: 4, category: 'Demon', name: 'Level 1', flames: 40, orbs: 10, needed: true },
            { id: 5, category: 'Demon', name: 'Level 2', stars: 4, needed: true },
            { id: 6, category: 'Demon', name: 'Level 3', crystals: 12, stars: 6, needed: true },
            { id: 7, category: 'Mountains', name: 'Level 1', crystals: 10, orbs: 15, needed: true },
            { id: 8, category: 'Mountains', name: 'Level 2', flames: 50, crystals: 20, needed: true },
            { id: 9, category: 'Scrolls', name: 'Nature', crystals: 15, needed: true },
            { id: 10, category: 'Scrolls', name: 'Plenty', flames: 50, crystals: 10, needed: true },
            { id: 11, category: 'Scrolls', name: 'Industry', flames: 75, crystals: 15, needed: true },
            { id: 12, category: 'Scrolls', name: 'Might', flames: 50, needed: true },
            { id: 13, category: 'Scrolls', name: 'Dark', crystals: 15, stars: 1, needed: true },
            { id: 14, category: 'Scrolls', name: 'Magic', flames: 75, needed: true },
            { id: 15, category: 'Scrolls', name: 'Unending', stars: 4, needed: true },
            { id: 16, category: 'Scrolls', name: 'Growth', flames: 25, stars: 6, needed: true },
            { id: 17, category: 'Scrolls', name: 'Dead', flames: 25, needed: true },
            { id: 18, category: 'Scrolls', name: 'Troll', flames: 20, crystals: 5, needed: true },
            { id: 19, category: 'Scrolls', name: 'Scales', crystals: 10, stars: 2, needed: true },
            { id: 20, category: 'Scrolls', name: 'Time', flames: 35, needed: true },
            { id: 21, category: 'Scrolls', name: 'Nether', flames: 50, crystals: 10, needed: true },
            { id: 22, category: 'DDD', name: 'Level 7', flames: 150, crystals: 25, needed: true },
            { id: 23, category: 'DDD', name: 'Level 8', crystals: 50, stars: 25, needed: true },
            { id: 24, category: 'DDD', name: 'Level 10', stars: 50, needed: true }
        ];

        document.addEventListener('DOMContentLoaded', () => {
            const upgradesContainer = document.getElementById('upgrades-container');
            const strategyTextEl = document.getElementById('strategy-text');

            // Total Needed Elements
            const totalsOrbsEl = document.getElementById('total-orbs');
            const totalsFlamesEl = document.getElementById('total-flames');
            const totalsCrystalsEl = document.getElementById('total-crystals');
            const totalsStarsEl = document.getElementById('total-stars');

            // Current Resources Inputs
            const currentOrbsInput = document.getElementById('current-orbs');
            const currentFlamesInput = document.getElementById('current-flames');
            const currentCrystalsInput = document.getElementById('current-crystals');
            const currentStarsInput = document.getElementById('current-stars');
            
            // Production Inputs
            const flamesPerNetherlingInput = document.getElementById('flames-per-netherling');
            const crystalsPerDemonInput = document.getElementById('crystals-per-demon');
            const starsPerMountainInput = document.getElementById('stars-per-mountain');

            // Spawn Cost Elements
            const spawnCostOrbsEl = document.getElementById('spawn-cost-orbs');
            const spawnCostFlamesEl = document.getElementById('spawn-cost-flames');
            const spawnCostCrystalsEl = document.getElementById('spawn-cost-crystals');
            const spawnCostStarsEl = document.getElementById('spawn-cost-stars');

            function getProductionPlan(needed) {
                const flamesPerNetherling = parseInt(flamesPerNetherlingInput.value) || 0;
                const crystalsPerDemon = parseInt(crystalsPerDemonInput.value) || 0;
                const starsPerMountain = parseInt(starsPerMountainInput.value) || 0;

                let numMountains = 0, crystalsForMountains = 0;
                if (needed.stars > 0 && starsPerMountain > 0) {
                    numMountains = Math.ceil(needed.stars / starsPerMountain);
                    crystalsForMountains = numMountains * 12;
                }
                
                const totalCrystalsNeeded = needed.crystals + crystalsForMountains;
                let numDemons = 0, flamesForDemons = 0, orbsForDemons = 0;
                if (totalCrystalsNeeded > 0 && crystalsPerDemon > 0) {
                    numDemons = Math.ceil(totalCrystalsNeeded / crystalsPerDemon);
                    flamesForDemons = numDemons * 10;
                    orbsForDemons = numDemons * 3;
                }

                const totalFlamesNeeded = needed.flames + flamesForDemons;
                let numNetherlings = 0, orbsForNetherlings = 0;
                if (totalFlamesNeeded > 0 && flamesPerNetherling > 0) {
                    numNetherlings = Math.ceil(totalFlamesNeeded / flamesPerNetherling);
                    orbsForNetherlings = numNetherlings * 1;
                }

                return {
                    numMountains, crystalsForMountains,
                    numDemons, flamesForDemons, orbsForDemons, totalCrystalsNeeded,
                    numNetherlings, orbsForNetherlings, totalFlamesNeeded
                };
            }

            function calculateAndDisplaySpawnCosts(needed) {
                const plan = getProductionPlan(needed);
                
                const totalSpawnCost = {
                    orbs: plan.orbsForDemons + plan.orbsForNetherlings,
                    flames: plan.flamesForDemons,
                    crystals: plan.crystalsForMountains,
                    stars: 0
                };

                // Update the DOM for the dedicated spawn cost section
                spawnCostOrbsEl.textContent = totalSpawnCost.orbs.toLocaleString();
                spawnCostFlamesEl.textContent = totalSpawnCost.flames.toLocaleString();
                spawnCostCrystalsEl.textContent = totalSpawnCost.crystals.toLocaleString();
                spawnCostStarsEl.textContent = '0';
                
                return totalSpawnCost;
            }
            
            function generateStrategyText(needed) {
                const flamesPerNetherling = parseInt(flamesPerNetherlingInput.value) || 0;
                const crystalsPerDemon = parseInt(crystalsPerDemonInput.value) || 0;
                const starsPerMountain = parseInt(starsPerMountainInput.value) || 0;
                let steps = [];

                const totalNeededValue = Object.values(needed).reduce((a, b) => a + b, 0);
                if (totalNeededValue === 0) {
                    strategyTextEl.innerHTML = '<p>You have all the resources for the selected upgrades!</p>';
                    return;
                }

                const plan = getProductionPlan(needed);

                if (needed.stars > 0) {
                    if (starsPerMountain <= 0) {
                        steps.push(`<p class="text-red-400">You need ${needed.stars.toLocaleString()} ⭐, but can't produce them. Enter a value for 'Stars per Mountain'.</p>`);
                    } else {
                        steps.push(`<p>To get the required <strong class="text-yellow-400">${needed.stars.toLocaleString()} stars</strong>, you'll need to spawn ~<strong>${plan.numMountains.toLocaleString()} Mountains</strong>. This will cost <strong class="text-cyan-400">${plan.crystalsForMountains.toLocaleString()} crystals</strong>.</p>`);
                    }
                }

                if (plan.totalCrystalsNeeded > 0) {
                    if (crystalsPerDemon <= 0) {
                        steps.push(`<p class="text-red-400">You need a total of ${plan.totalCrystalsNeeded.toLocaleString()} 💎, but can't produce them. Enter a value for 'Crystals per Demon'.</p>`);
                    } else {
                        steps.push(`<p>To cover the <strong class="text-cyan-400">${plan.totalCrystalsNeeded.toLocaleString()} crystals</strong> (for upgrades and spawning), you need to spawn ~<strong>${plan.numDemons.toLocaleString()} Demons</strong>. This will cost <strong class="text-orange-400">${plan.flamesForDemons.toLocaleString()} flames</strong> and <strong class="text-purple-400">${plan.orbsForDemons.toLocaleString()} orbs</strong>.</p>`);
                    }
                }

                if (plan.totalFlamesNeeded > 0) {
                    if (flamesPerNetherling <= 0) {
                        steps.push(`<p class="text-red-400">You need a total of ${plan.totalFlamesNeeded.toLocaleString()} 🔥, but can't produce them. Enter a value for 'Flames per Netherling'.</p>`);
                    } else {
                        steps.push(`<p>For the <strong class="text-orange-400">${plan.totalFlamesNeeded.toLocaleString()} flames</strong> required, you must spawn ~<strong>${plan.numNetherlings.toLocaleString()} Netherlings</strong>, costing <strong class="text-purple-400">${plan.orbsForNetherlings.toLocaleString()} orbs</strong>.</p>`);
                    }
                }
                
                if (needed.orbs > 0) {
                     steps.push(`<p>You also need an additional <strong class="text-purple-400">${needed.orbs.toLocaleString()} orbs</strong> directly for upgrades.</p>`);
                }

                if (steps.length > 0) {
                    strategyTextEl.innerHTML = steps.join('');
                } else {
                    strategyTextEl.innerHTML = '<p>Select some upgrades and enter your production rates to see a step-by-step plan.</p>';
                }
            }


            function calculateTotals() {
                const grossTotals = upgradesData.reduce((acc, upgrade) => {
                    if (upgrade.needed) {
                        acc.orbs += upgrade.orbs || 0;
                        acc.flames += upgrade.flames || 0;
                        acc.crystals += upgrade.crystals || 0;
                        acc.stars += upgrade.stars || 0;
                    }
                    return acc;
                }, { flames: 0, crystals: 0, stars: 0, orbs: 0 });

                const currentResources = {
                    orbs: parseInt(currentOrbsInput.value) || 0,
                    flames: parseInt(currentFlamesInput.value) || 0,
                    crystals: parseInt(currentCrystalsInput.value) || 0,
                    stars: parseInt(currentStarsInput.value) || 0,
                };

                const netUpgradeCost = {
                    orbs: Math.max(0, grossTotals.orbs - currentResources.orbs),
                    flames: Math.max(0, grossTotals.flames - currentResources.flames),
                    crystals: Math.max(0, grossTotals.crystals - currentResources.crystals),
                    stars: Math.max(0, grossTotals.stars - currentResources.stars),
                };

                const spawnCosts = calculateAndDisplaySpawnCosts(netUpgradeCost);

                const finalTotals = {
                    orbs: netUpgradeCost.orbs + spawnCosts.orbs,
                    flames: netUpgradeCost.flames + spawnCosts.flames,
                    crystals: netUpgradeCost.crystals + spawnCosts.crystals,
                    stars: netUpgradeCost.stars + spawnCosts.stars,
                };

                totalsOrbsEl.textContent = finalTotals.orbs.toLocaleString();
                totalsFlamesEl.textContent = finalTotals.flames.toLocaleString();
                totalsCrystalsEl.textContent = finalTotals.crystals.toLocaleString();
                totalsStarsEl.textContent = finalTotals.stars.toLocaleString();

                generateStrategyText(netUpgradeCost);
            }

            function renderUpgrades() {
                // Group upgrades by category
                const groupedUpgrades = upgradesData.reduce((acc, upgrade) => {
                    if (!acc[upgrade.category]) {
                        acc[upgrade.category] = [];
                    }
                    acc[upgrade.category].push(upgrade);
                    return acc;
                }, {});

                upgradesContainer.innerHTML = ''; // Clear existing content

                for (const category in groupedUpgrades) {
                    const categoryContainer = document.createElement('div');
                    categoryContainer.className = 'bg-gray-800 shadow-lg rounded-xl border border-gray-700';
                    
                    const categoryHeader = document.createElement('h3');
                    categoryHeader.className = 'text-lg font-semibold text-indigo-300 p-4 border-b border-gray-700';
                    categoryHeader.textContent = category;
                    categoryContainer.appendChild(categoryHeader);

                    const list = document.createElement('ul');
                    list.className = 'divide-y divide-gray-700';
                    
                    groupedUpgrades[category].forEach(upgrade => {
                        const item = document.createElement('li');
                        item.className = 'flex items-center justify-between p-4 flex-wrap';
                        
                        item.innerHTML = `
                            <div class="flex items-center mb-2 sm:mb-0">
                                <input type="checkbox" id="upgrade-${upgrade.id}" data-id="${upgrade.id}" class="custom-checkbox appearance-none w-5 h-5 rounded border-2 border-gray-500 bg-gray-600 transition-all duration-200 cursor-pointer" ${upgrade.needed ? 'checked' : ''}>
                                <label for="upgrade-${upgrade.id}" class="ml-4 text-gray-200 cursor-pointer">${upgrade.name}</label>
                            </div>
                            <div class="flex items-center space-x-4 text-sm w-full sm:w-auto justify-end">
                                ${upgrade.orbs ? `<span class="text-purple-400 font-medium">${upgrade.orbs.toLocaleString()} 🔮</span>` : ''}
                                ${upgrade.flames ? `<span class="text-orange-400 font-medium">${upgrade.flames.toLocaleString()} 🔥</span>` : ''}
                                ${upgrade.crystals ? `<span class="text-cyan-400 font-medium">${upgrade.crystals.toLocaleString()} 💎</span>` : ''}
                                ${upgrade.stars ? `<span class="text-yellow-400 font-medium">${upgrade.stars.toLocaleString()} ⭐</span>` : ''}
                            </div>
                        `;
                        list.appendChild(item);
                    });

                    categoryContainer.appendChild(list);
                    upgradesContainer.appendChild(categoryContainer);
                }
            }
            
            upgradesContainer.addEventListener('change', (e) => {
                if (e.target.type === 'checkbox') {
                    const upgradeId = parseInt(e.target.dataset.id);
                    const upgrade = upgradesData.find(u => u.id === upgradeId);
                    if (upgrade) {
                        upgrade.needed = e.target.checked;
                        calculateTotals();
                    }
                }
            });

            const allInputs = [
                currentOrbsInput, currentFlamesInput, currentCrystalsInput, currentStarsInput,
                flamesPerNetherlingInput, crystalsPerDemonInput, starsPerMountainInput
            ];

            allInputs.forEach(input => {
                input.addEventListener('input', calculateTotals);
            });

            // Initial setup
            renderUpgrades();
            calculateTotals();
        });
    </script>
</body>
</html>


